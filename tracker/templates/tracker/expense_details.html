{% extends 'tracker/base.html' %}
{% load static %}
{% block title %}Split Expense{% endblock %}

{% block content %}
<div id="split-root"
     data-amount="{{ amount }}"
     data-username="{{ user.name }}"
     data-userid="{{ user.id }}"
     data-friendname="{{ friend.name }}"
     data-friendid="{{ friend.id }}"
     class="card shadow p-4 mt-4 text-center">

    <div id="simple-split-view">
        <div class="alert alert-secondary" role="alert" style="font-size: 1.1rem;">
            Paid by 
            <button type="button" class="btn btn-light btn-lg" id="paid-by-btn">You</button>
            and split 
            <button type="button" class="btn btn-light btn-lg" id="change-split-btn">Equally</button>.
        </div>
    </div>

    <div id="advanced-split-view" class="card mb-3" style="display:none;">
        <div class="card-header">
            <ul class="nav nav-tabs card-header-tabs" id="split-method-tabs">
                <li class="nav-item">
                    <a class="nav-link split-btn active" href="#" data-method="equal" title="Equally">=</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link split-btn" href="#" data-method="exact" title="Exact Amount">1.23</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link split-btn" href="#" data-method="percent" title="Percentage">%</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link split-btn" href="#" data-method="adjust" title="Adjustment">+/-</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link split-btn" href="#" data-method="shares" title="Shares">Shares</a>
                </li>
            </ul>
        </div>
        <div class="card-body">
            <h5 id="split-heading">Split equally</h5>
            <div id="split-content" class="mt-3"></div>

            <hr>
            <button type="button" id="fewer-options-btn" class="btn btn-link btn-sm">Fewer options</button>
        </div>
    </div>

    <form id="split-expense-form" class="mt-4">
        {% csrf_token %}
        <input type="hidden" name="title" value="{{ title }}">
        <input type="hidden" name="description" value="{{ description }}">
        <input type="hidden" name="category" value="{{ category }}">
        <input type="hidden" name="amount" value="{{ amount }}">
        
        <input type="hidden" name="paid_by" id="paid_by_field" value="{{ user.id }}">
        
        <input type="hidden" name="split_method" id="split_method_field" value="equal">
        
        <input type="hidden" name="user_share" id="user_share_field" value="{{ amount|floatformat:2 }}">
        <input type="hidden" name="friend_share" id="friend_share_field" value="0">
        
        <button type="submit" class="btn btn-success mt-3" id="save-split-btn">Save Split</button>
    </form>
</div>
{% endblock %}
{% block scripts %}
    <script src="{% static 'tracker/js/group_split_expenses.js' %}"></script>
{% endblock %}